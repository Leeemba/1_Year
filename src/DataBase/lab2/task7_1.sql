SELECT COUNT(DISTINCT s.ЧЛВК_ИД) AS троечники
FROM  Н_УЧЕНИКИ AS s
JOIN Н_ВЕДОМОСТИ ON s.ЧЛВК_ИД= Н_ВЕДОМОСТИ.ЧЛВК_ИД
JOIN Н_ПЛАНЫ ON s.ПЛАН_ИД = Н_ПЛАНЫ.ИД
JOIN Н_ОТДЕЛЫ ON Н_ОТДЕЛЫ.ИД= Н_ПЛАНЫ.ОТД_ИД
WHERE Н_ОТДЕЛЫ.КОРОТКОЕ_ИМЯ ='КТиУ'

AND NOT EXISTS(SELECT *
    FROM Н_ВЕДОМОСТИ AS v
    WHERE v.ЧЛВК_ИД =  s.ЧЛВК_ИД
    AND  Н_ВЕДОМОСТИ.ОЦЕНКА NOT IN('3','зачет','осв')
    )